# feature extractor
model_name: /g/kreshuk/hilt/storage/synthetic_noisy_nuclei/fe_l2_cosine_usaff.pth
load_pretrained: true
optim: "none"  # none/rl_loss  # optimize feature extractor with ril loss, fe extractor optimization works only when fe is part of the agent (MC). In the embedding space environment fe is part of the env

n_embedding_features: 16  # number of embedding feature channels
contrastive_delta_dist: 0.3
contrastive_delta_var: 0.1
distance: cosine  # if none defaults to l2, distance in embedding space
backbone:
  name: UNet2D
  in_channels: 3
  out_channels: 16
  # use Groupnorm instead of Batchnorm for DSB; Batchnorm introduces artifacts around nuclei due to the difference
  # in intensity distribution between images with large and small cells
  layer_order: bcr
#  num_groups: 8
  f_maps: [32, 64, 128]
  #conv_padding: 0
  final_sigmoid: false
  is_segmentation: false

#warmup:  # the feature extractor might need pretraining to produce meaningful features
#  # Adam optim conf
#  lr: 0.0001
#
#  method: 'affinity_contrast'
#  n_iterations: 900 # number of iterations of feature extrqactor warmup
#  batch_size: 10  # batch size for feature extractor warmup
#
#  patch_manager:
#    name: none # rotated, no_cross, none
#    reorder_sp: true


